<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Setting up Pumilio and Usage of the pumilioR Package</title>
    <!-- Bootstrap -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- 
    <link href="bootstrap/css/jumbotron-narrow.css" rel="stylesheet">
    -->

    <!-- Custom styles for this template -->

        
    <!-- Bootstrap theme -->
    <link href="bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body role="document">

    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="./">PumilioR</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="./">Home</a></li>
            <li class="active"><a href="pumiliosetup.html">Instructions and Examples</a></li>
            <li><a href="http://cran.r-project.org/web/packages/pumilioR">Package on CRAN</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

 <div class="container" role="main">


<!-- Main jumbotron for a primary marketing message or call to action -->
<div class="jumbotron" style="padding-left:10px;padding-bottom:10px;">
	<h2>Setting up Pumilio and Usage of the <em>pumilioR</em> Package</h2>
</div>



<h3>Introduction</h3>

<p>The <em>pumilioR</em> package has functions to get data and sound files from the web-based sound archive system Pumilio (<a href="http://ljvillanueva.github.io/pumilio">http://ljvillanueva.github.io/pumilio</a>). This introduction will provide a brief overview of setting up Pumilio and examples of how to query the system and extract both data and soundfiles.</p>

<p><em>pumilioR</em> requires R version 2.14, or newer, and depends on the packages <em>XML</em> and <em>RCurl</em>. </p>

<p>The source of the package is kept at Github: <a href="https://github.com/ljvillanueva/pumilioR">https://github.com/ljvillanueva/pumilioR</a></p>

<p>The website of the package is <a href="http://ljvillanueva.github.io/pumilioR/">http://ljvillanueva.github.io/pumilioR/</a></p>

<h3>Pumilio Setup</h3>

<p>To allow the use of the package, log in as an administrator to the Pumilio system. Click the Admin menu link (on the top right edge of the page). On the main settings page of the Admin menu, under &ldquo;System behavior&rdquo;, there is an option:</p>

<ul>
<li>Allow access using XML: Yes/No</li>
</ul>

<p>Set it to Yes. Now <em>pumilioR</em>, and other programs, can read data from the archive using XML.</p>

<p>To limit the access to valid users registered in the Pumilio system, set the option:</p>

<ul>
<li>Who can access via XML: Any/Users</li>
</ul>

<p>to Users. To allow anyone to query the system set it to Any.</p>

<h3>Check access</h3>

<p>Before querying the system, first check that it is properly configured and that you can access it, for example:</p>

<pre># Load the package
library(pumilioR)

# Check that the system can use pumilioR, returns TRUE if it is allowed and
# the version supports it
access &lt;- checkVersion(pumilio_URL = &quot;http://pumilio.coquipr.com/pumilio/&quot;)
</pre>

<blockquote>
<pre>
  Pumilio is running version 2.7.0
    and the XML access is set to: TRUE
</pre>
</blockquote>


<pre>
access
</pre>

<blockquote>
<pre>[1] &quot;TRUE&quot;
</pre>
</blockquote>

<h3>Querying the system</h3>

<p>To query the system, use the functions <em>getCollections()</em> or <em>getSites()</em> to get a data frame with the collections and the sites, respectively, in the system. Then, you can get the sounds for that collection or site using the function <em>getSounds()</em>. For example:</p>

<pre># Get all collections
cols &lt;- getCollections(pumilio_URL = &quot;http://pumilio.coquipr.com/pumilio/&quot;)
</pre>

<blockquote>
<pre> 
   Found 15 results
</pre>
</blockquote>

<pre>
# Show the first row
cols[1, ]
</pre>

<blockquote>
<pre>   ColID CollectionName Author            FilesSource
 1   101           01-A    LJV Automated Audio Logger
   CollectionFullCitation  URL
 1                   NULL NULL
                                                                    Notes
 1 LJV A  Deployed on 20-oct-03 14:23  LEF. Next to the road, 191, km 9.3
</pre>
</blockquote>

<pre>
# Get all sites
sites &lt;- getSites(pumilio_URL = &quot;http://pumilio.coquipr.com/pumilio/&quot;)
</pre>

<blockquote>
<pre>  
   Found 14 results
</pre>
</blockquote>

<pre>
# Show the first row
sites[1, ]
</pre>

<blockquote>
<pre>
 1    102 LEF - Road 191, km 9.3  18.3119  -65.7736      NULL  NULL
</pre>
</blockquote>

<pre>
# Get all the sounds in the site with the SiteID = 102
sounds &lt;- getSounds(pumilio_URL = &quot;http://pumilio.coquipr.com/pumilio/&quot;, SiteID = 102, 
type = &quot;site&quot;)
</pre>

<blockquote>
<pre>  
   Found 50 results
</pre>
</blockquote>

<pre>
# Show the first row
sounds[1, ]
</pre>

<blockquote>
<pre>   SoundID ColID SiteID              OriginalFilename
 1     234   101    102 LINE_2003-10-30_23_30_37.flac
                  SoundName day month year hour minutes seconds
 1 LINE_2003-10-30_23_30_37  30    10 2003   23      30      37
   SamplingRate BitRate Channels Duration SoundFormat SensorID Notes
 1        48000      16        1    59.36        flac      101  NULL
             timestamp FileSize
 1 2010-11-10 10:05:58  2610263
                                                                                FilePath
 1 http://pumilio.coquipr.com/pumilio/sounds/sounds/101/50/LINE_2003-10-30_23_30_37.flac
   AudioPreviewFormat AudioPreviewFilename
 1                mp3  234.autopreview.mp3
                                                                 AudioPreviewFilePath
 1 http://pumilio.coquipr.com/pumilio/sounds/previewsounds/101/50/234.autopreview.mp3
</pre>
</blockquote>

<h3>Download files</h3>

<p>Once a result is obtained from the system, the audio file can be downloaded using the function <em>getFile()</em>. This function needs the result of either <em>getCollections()</em> or <em>getSites()</em> and the SoundID of the desired file.</p>

<pre># First, get a list of results
results &lt;- getSounds(pumilio_URL = &quot;http://pumilio.coquipr.com/pumilio/&quot;, SiteID = 111, 
type = &quot;site&quot;)
</pre>

<blockquote>
<pre>
   Found 155 results
</pre>
</blockquote>

<pre>
results[1, ]
</pre>

<blockquote>
<pre>   SoundID ColID SiteID              OriginalFilename
 1    4078   122    111 LINE_2004-03-20_02_01_11.flac
                  SoundName day month year hour minutes seconds
 1 LINE_2004-03-20_02_01_11  20     3 2004   02      01      11
   SamplingRate BitRate Channels Duration SoundFormat SensorID Notes
 1        48000      16        2  59.4027        flac      101  NULL
             timestamp FileSize
 1 2010-12-09 11:12:49  2943180
                                                                                FilePath
 1 http://pumilio.coquipr.com/pumilio/sounds/sounds/122/29/LINE_2004-03-20_02_01_11.flac
   AudioPreviewFormat                     AudioPreviewFilename
 1                mp3 LINE_2004-03-20_02_01_11.autopreview.mp3
                                                                                      AudioPreviewFilePath
 1 http://pumilio.coquipr.com/pumilio/sounds/previewsounds/122/29/LINE_2004-03-20_02_01_11.autopreview.mp3
</pre>
</blockquote>

<p>Then, get the file from the first row, identified with the SoundID 4078. The audio file is saved in the working directory.</p>

<pre>
getFile(results, SoundID = 4078)
</pre>

<h2>Apache Basic Authentication</h2>

<p>Basic authentication can be used on the Apache webserver as a way to limit access to the data by requiring a username and password. This is outside the scope of this vignette. Since version 1.2 of <em>pumilioR</em> these sites can be accessed providing the username and password, separated with a colon, to the argument <em>credentials</em> in each function.</p>

<pre>sites &lt;- getSites(pumilio_URL = &quot;http://pumilio.coquipr.com/pumilio2/&quot;, credentials = &quot;pumilio:pumilio&quot;)
</pre>

<blockquote>
<pre>  
   Found 14 results
</pre>
</blockquote>

<pre>
sites[1, ]
</pre>

<blockquote>
<pre>   SiteID               SiteName latitude longitude elevation notes
 1    102 LEF - Road 191, km 9.3  18.3119  -65.7736      NULL  NULL
</pre>
</blockquote>

<h3>Pumilio User Authentication</h3>

<p>Since version 1.2 of <em>pumilioR</em> and version 2.7.0 of Pumilio, the system can be accessed providing a valid username and password, separated with a colon, already registered in the system to the argument <em>pumiliologin</em> in each function.</p>

<pre>sites &lt;- getSites(pumilio_URL = &quot;http://pumilio.coquipr.com/pumilio3/&quot;, pumiliologin = &quot;pumilio:pumilio&quot;)
</pre>

<blockquote>
<pre>  
   Found 14 results
</pre>
</blockquote>

<pre>
sites[1, ]
</pre>

<blockquote>
<pre>   SiteID               SiteName latitude longitude elevation notes
 1    102 LEF - Road 191, km 9.3  18.3119  -65.7736      NULL  NULL
</pre>
</blockquote>

<h3>Package website</h3>

<p>Please visit the package website for more information and updates: <a href="http://ljvillanueva.github.io/pumilioR/">http://ljvillanueva.github.io/pumilioR/</a></p>

<p>For suggestions or to report bugs or problems: <a href="http://github.com/ljvillanueva/pumilioR/issues">http://github.com/ljvillanueva/pumilioR/issues</a></p>

<p>The package page in CRAN is <a href="http://cran.r-project.org/web/packages/pumilioR/">http://cran.r-project.org/web/packages/pumilioR/</a></p>

<hr/>

<p>Vignette &ldquo;Setting up Pumilio and Usage of the <em>pumilioR</em> Package&rdquo; by LJ Villanueva-Rivera</p>

<p><em>Version 1.0 (1 February 2014)</em></p>


     <div id="footer">
        <br><p class="text-muted">Pumilio is maintained by <a href="https://github.com/ljvillanueva">ljvillanueva</a></p>
    </div> 

    </div>
  </body>
</html>
